<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="https://www.thymeleaf.org">
<head>
<meta charset="ISO-8859-1">
<title>Browse</title>
<link th:href="@{/styles/browse.css}" rel="stylesheet" />
<link rel="stylesheet"
	href="https://fonts.googleapis.com/css?family=Gemunu%20Libre">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
	crossorigin="anonymous">
<style type="text/css">
th {
	border: 2px solid rgb(173, 210, 252);
	background-color: #e9ecef;
	height: 60px;
}

td {
	overflow: hidden;
	text-overflow: ellipsis;
	border: 2px solid rgb(173, 210, 252);
	height: 40px;
	margin-bottom: .5em;
}

table.center {
	margin: 20px;
}
</style>
</head>
<!-- NAV BAR -->
<header>
	<!-- if no user is logged in... -->
	<nav class="navbar navbar-expand-sm fixed-top"
		style="background-color: rgb(25, 41, 77)" th:if="${user == null}">
		<div class="container-fluid">
			<!-- Left justified unordered list -->
			<ul class="navbar nav">
				<li class="nav-item"><a class="navbar-brand"
					th:href="@{/index}"> <img
						src="/images/university_depot_icon.png" alt="Home"
						style="width: 64px; height: 64px;"></img></a></li>
			</ul>
			<!-- Right justified unordered list -->
			<ul class="navbar nav ms-md-auto">
				<li class="nav-item ms-md-auto"><a class="nav-link text-white"
					style="font-family: 'Gemunu Libre'; font-size: 1.5em"
					th:href="@{/newUser}">Sign Up</a></li>
				<li class="nav-item ms-md-auto"><a class="nav-link text-white"
					style="font-family: 'Gemunu Libre'; font-size: 1.5em"
					th:href="@{/homePage}">Log In</a></li>
			</ul>
		</div>
	</nav>
	<!-- if a user is logged in... -->
	<nav class="navbar navbar-expand-sm fixed-top"
		style="background-color: rgb(25, 41, 77)" th:unless="${user == null}">
		<div class="container-fluid">
			<!-- Left justified unordered list -->
			<ul class="navbar nav">
				<li class="nav-item"><a class="navbar-brand"
					th:href="@{/index}"> <img
						src="/images/university_depot_icon.png" alt="Home"
						style="width: 64px; height: 64px;"></img></a></li>
				<li class="nav-item"><a class="nav-link text-white"
					style="font-family: 'Gemunu Libre'; font-size: 1.5em"
					href="/userDetails">My Account</a></li>
			</ul>
			<!-- Right justified unordered list -->
			<ul class="navbar nav ms-md-auto">
				<li class="nav-item ms-md-auto"><a class="nav-link text-white"
					style="font-family: 'Gemunu Libre'; font-size: 1.5em"
					href="/do_the_logout">Log Out</a></li>
			</ul>
		</div>
	</nav>
</header>

<body>
	<!-- Modal if user tries to sell without having payment information set up. -->
	<div class="modal" id="sellErrorModal">
		<div class="modal-dialog">
			<div class="modal-content">

				<!-- Modal Header -->
				<div class="modal-header">
					<h4 class="modal-title">Payment Information Required</h4>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>

				<!-- Modal body -->
				<div class="modal-body">
					<p>
						To sell items on University Depot, you must first set up some
						payment information. We will need <b>Card information</b> <i>and</i>
						<b>Direct Deposit</b> details. To set this up now, click <a
							href="userDetails/paymentDetails">here</a>.
					</p>
					<p>If you would like to do this later, you can find your
						payment information by clicking your user icon in the upper right
						corner of the top navigation bar and selecting "Payment Info" from
						the dropdown at any time.</p>
				</div>

				<!-- Modal footer -->
				<div class="modal-footer">
					<button type="button" class="btn btn-danger"
						data-bs-dismiss="modal">Close</button>
				</div>
			</div>
		</div>
	</div>

	
		<div id="sidebar" style="width: 142px">
			<th:block th:switch="${user.role}" th:unless="${user == null}">
				<nav class="navbar bg-dark align-items-start" style="height: 150%">
					<div class="container-fluid">
						<ul class="nav nav-pills flex-column mb-auto bg-dark">
							<li class="nav-item" th:each="tab: ${allTabs}"
								th:if="${tab.role == user.role}"><a class="nav-link"
								th:href="${tab.linkTo}" th:text="${tab.displayText}"
								th:unless="${tab.linkTo == '/addWidget'}">displayText</a> <a
								th:if="${tab.linkTo == '/addWidget' && user.directDepositDetails != null && (user.paypal != null || user.paymentDetails != null)}"
								href="/addWidget" class="nav-link"> Sell Items </a> <a
								th:if="${tab.linkTo == '/addWidget'}"
								th:unless="${user.directDepositDetails != null && (user.paypal != null || user.paymentDetails != null)}"
								href="#" data-bs-toggle="modal" data-bs-target="#sellErrorModal"
								class="nav-link"> Sell Items </a></li>

						</ul>
					</div>
				</nav>
			</th:block>
		</div>
		<!-- END SIDE NAV BAR -->


	<div class="grid-container">

		<div class="grid-item item5">
			<th:block th:switch="${page}">
				<div th:case="searchWidgetSellerMarketListing">

					<th:block th:each="searchedMarkets: ${allMarketListings}"
						th:unless="${searchedMarkets.qtyAvailable == 0 || searchedMarkets.isDeleted}">


						<table class="center" style="float: left; width: 30%;">

							<tr>

								<th colspan="2"><p
										th:text="${searchedMarkets.widgetSold.name}"></p></th>

							</tr>

							<tr>
								<td colspan="2"><img
									th:if="${searchedMarkets.imageName == null}"
									style="width: 200px; height: 200px;"
									src="https://previews.123rf.com/images/kritchanut/kritchanut1406/kritchanut140600093/29213195-.jpg?fj=1"
									alt="Blank Listing Avatar"> <img
									th:unless="${searchedMarkets.imageName == null}"
									style="width: 200px; height: 200px;"
									th:src="@{/listingImages/{image}(image = ${searchedMarkets.imageName})}"
									alt="Listing Avatar" src=""></td>
							</tr>
							<tr>
								<td><p>Quantity Available:</p>
									<p th:text="${searchedMarkets.qtyAvailable}"></p></td>
								<td><p>Price Per:</p>
									<p th:text="${searchedMarkets.pricePerItem}"></p></td>
							</tr>
							<tr>
								<th colspan="2"><a class="submit"
									style="height: 40px; width: 120px;"
									th:href="@{/viewMarketListing/{id}(id = ${searchedMarkets.id})}"><span>View
											Listing</span></a></th>
							</tr>
						</table>
					</th:block>
				</div>
			</th:block>
		</div>

		<div th:if="${#lists.isEmpty(allMarketListings)}">
			<h2>There are no listings currently on the market.</h2>
		</div>
	</div>



	<div></div>
</body>
</html>